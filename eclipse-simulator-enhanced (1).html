<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Solar System Eclipse Simulator</title>

  <!-- Tailwind CDN for quick styling (same look as your React app) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    html,body { height:100%; margin:0; background:linear-gradient(180deg,#071032,#2b0265); color:#fff; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }
    .container { max-width:1200px; margin:0 auto; padding:16px; }
    /* make canvas responsive and keep aspect */
    #canvas-wrap { background: rgba(0,0,0,0.35); border-radius: 12px; padding:12px; }
    canvas { width:100%; height:520px; display:block; border-radius:8px; background:#000011; }
    /* small helper */
    .btn-outline { border: 1px solid rgba(148,163,184,0.18); }
    .eclipse-img { width:100%; height:auto; border-radius:8px; object-fit:cover; }
    /* active button styling */
    .active-type { box-shadow: 0 6px 18px rgba(99,102,241,0.25); outline: 2px solid rgba(99,102,241,0.25); }
    @media (max-width: 768px) {
      canvas { height: 420px; }
    }
  </style>
</head>
<body>
  <div class="container mx-auto">
    <header class="text-center mb-6">
      <h1 class="text-4xl font-extrabold mb-2">Solar System Eclipse Simulator</h1>
      <p class="text-lg text-blue-200">Explore different types of eclipses ‚Äî all in your browser</p>
    </header>

    <div class="grid gap-6 lg:grid-cols-3 mb-6">
      <!-- Controls -->
      <div class="bg-blue-900/30 rounded-lg p-4">
        <h2 class="text-xl font-semibold mb-4">Simulation Controls</h2>

        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium mb-2">Speed: <span id="speedLabel">1.0x</span></label>
            <input id="speedRange" type="range" min="0.1" max="10" step="0.1" value="1" class="w-full" />
          </div>

          <div class="flex gap-3">
            <button id="playPauseBtn" class="flex-1 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">Pause</button>
            <button id="resetBtn" class="flex-1 bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded">Reset</button>
          </div>

          <div>
            <label class="block text-sm font-medium mb-2">Viewpoint</label>
            <select id="viewpointSelect" class="w-full bg-blue-800 border border-blue-700 rounded px-3 py-2">
              <option value="sun">Sun-centered</option>
              <option value="earth">Earth-centered</option>
            </select>
          </div>

          <div class="flex items-center gap-2">
            <input id="showLabels" type="checkbox" checked class="w-4 h-4" />
            <label for="showLabels" class="text-sm">Show planet labels</label>
          </div>
        </div>
      </div>

      <!-- Canvas -->
      <div id="canvas-wrap" class="lg:col-span-2 rounded-lg p-3">
        <canvas id="simCanvas"></canvas>
      </div>
    </div>

    <!-- Eclipse types -->
    <section class="bg-blue-900/30 rounded-lg p-6 mb-6">
      <h2 class="text-2xl font-semibold mb-4">Eclipse Types</h2>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <button id="typeSolar" class="p-4 rounded-lg bg-blue-800/60 border hover:bg-blue-700/70">Solar Eclipse</button>
        <button id="typeLunar" class="p-4 rounded-lg bg-blue-800/60 border hover:bg-blue-700/70">Lunar Eclipse</button>
        <button id="typeTransit" class="p-4 rounded-lg bg-blue-800/60 border hover:bg-blue-700/70">Planetary Transit</button>
      </div>

      <div class="bg-blue-900/50 rounded-lg p-4">
        <div class="flex flex-col md:flex-row gap-6 items-start">
          <img id="eclipseImage" src="https://upload.wikimedia.org/wikipedia/commons/8/83/Total_solar_eclipse_1999_08_11.jpg" alt="eclipse" class="eclipse-img md:w-1/3" />
          <div class="flex-1">
            <h3 id="eclipseTitle" class="text-xl font-semibold mb-2">Solar Eclipse</h3>
            <p id="eclipseDesc" class="text-blue-100 mb-4">Occurs when the Moon passes between Earth and the Sun, blocking the Sun's light. Can be total, partial, or annular.</p>

            <div class="mt-4 p-3 bg-blue-800/30 rounded">
              <strong>Current Simulation Status:</strong>
              <span id="simStatus" class="ml-2">No eclipse currently visible</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Dedicated Eclipse Simulation -->
    <section class="bg-blue-900/30 rounded-lg p-6 mb-6">
      <h2 class="text-2xl font-semibold mb-4">üåë Eclipse Mechanics Simulator</h2>
      <p class="text-blue-200 mb-4">Watch how eclipses happen in real-time with just Sun, Earth, and Moon</p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <button id="demoSolar" class="p-3 rounded-lg bg-orange-600 hover:bg-orange-700 font-semibold">‚ñ∂Ô∏è Simulate Solar Eclipse</button>
        <button id="demoLunar" class="p-3 rounded-lg bg-red-600 hover:bg-red-700 font-semibold">‚ñ∂Ô∏è Simulate Lunar Eclipse</button>
      </div>

      <div id="eclipse-demo-wrap" class="bg-black/50 rounded-lg p-4">
        <canvas id="eclipseDemo" style="width:100%; height:350px; display:block; border-radius:8px;"></canvas>
        <div class="mt-3 text-center">
          <span id="demoStatus" class="text-lg font-semibold text-yellow-300">Click a button above to see eclipse simulation</span>
        </div>
      </div>
    </section>

    <footer class="text-center text-blue-300 text-sm">
      <p>Solar System Eclipse Simulator ‚Ä¢ Canvas-based ‚Ä¢ Frontend-only</p>
    </footer>
  </div>

  <!-- Canvas simulation script -->
  <script>
    // ---- State & Data (converted from your React component) ----
    const canvas = document.getElementById('simCanvas');
    const ctx = canvas.getContext('2d');
    let simulationSpeed = 1;
    let isPlaying = true;
    let currentTime = 0;
    let showLabels = true;
    let viewpoint = 'sun'; // 'sun' or 'earth'
    let selectedEclipseType = 'solar';

    // DOM elements
    const speedRange = document.getElementById('speedRange');
    const speedLabel = document.getElementById('speedLabel');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const resetBtn = document.getElementById('resetBtn');
    const viewpointSelect = document.getElementById('viewpointSelect');
    const showLabelsCheckbox = document.getElementById('showLabels');
    const simStatus = document.getElementById('simStatus');
    const eclipseTitle = document.getElementById('eclipseTitle');
    const eclipseDesc = document.getElementById('eclipseDesc');
    const eclipseImage = document.getElementById('eclipseImage');

    const btnSolar = document.getElementById('typeSolar');
    const btnLunar = document.getElementById('typeLunar');
    const btnTransit = document.getElementById('typeTransit');

    // celestial bodies (same values as React version)
    const celestialBodies = {
      sun: { radius: 30, distance: 0, color: '#FFD700', orbitSpeed: 0 },
      mercury: { radius: 5, distance: 80, color: '#8C7853', orbitSpeed: 0.24 },
      venus: { radius: 8, distance: 120, color: '#FFC649', orbitSpeed: 0.62 },
      earth: { radius: 10, distance: 180, color: '#6B93D6', orbitSpeed: 1 },
      moon: { radius: 3, distance: 25, color: '#C0C0C0', orbitSpeed: 13.37, parent: 'earth' },
      mars: { radius: 7, distance: 240, color: '#CD5C5C', orbitSpeed: 1.88 },
      jupiter: { radius: 25, distance: 320, color: '#D8CA9D', orbitSpeed: 11.86 },
      saturn: { radius: 22, distance: 400, color: '#FAD5A5', orbitSpeed: 29.46 },
      uranus: { radius: 18, distance: 480, color: '#4FD0E3', orbitSpeed: 84.01 },
      neptune: { radius: 17, distance: 540, color: '#4B70DD', orbitSpeed: 164.8 }
    };

    // eclipse info
    const eclipseInfo = {
      solar: {
        title: "Solar Eclipse",
        description: "Occurs when the Moon passes between Earth and the Sun, blocking the Sun's light. Can be total, partial, or annular.",
        image: "https://upload.wikimedia.org/wikipedia/commons/8/83/Total_solar_eclipse_1999_08_11.jpg"
      },
      lunar: {
        title: "Lunar Eclipse",
        description: "Occurs when Earth passes between the Sun and Moon, casting Earth's shadow on the Moon.",
        image: "https://upload.wikimedia.org/wikipedia/commons/0/03/Lunar_eclipse_on_2008-02-21.jpg"
      },
      transit: {
        title: "Planetary Transit",
        description: "Occurs when a planet passes directly between Earth and the Sun, appearing as a small dark dot moving across the Sun's disk.",
        image: "https://upload.wikimedia.org/wikipedia/commons/6/6c/Mercury_transit_2006.png"
      }
    };

    // utility functions
    function getPlanetPosition(planet, time) {
      const body = celestialBodies[planet];
      const angle = (time * body.orbitSpeed * Math.PI / 180) % (2 * Math.PI);
      return { x: Math.cos(angle) * body.distance, y: Math.sin(angle) * body.distance };
    }

    function getMoonPosition(time) {
      const earthPos = getPlanetPosition('earth', time);
      const moonAngle = (time * celestialBodies.moon.orbitSpeed * Math.PI / 180) % (2 * Math.PI);
      return {
        x: earthPos.x + Math.cos(moonAngle) * celestialBodies.moon.distance,
        y: earthPos.y + Math.sin(moonAngle) * celestialBodies.moon.distance
      };
    }

    function detectEclipses(time) {
      const eclipses = [];
      const earthPos = getPlanetPosition('earth', time);
      const moonPos = getMoonPosition(time);
      const sunPos = { x: 0, y: 0 };

      const earthSunDistance = Math.hypot(earthPos.x, earthPos.y);
      const moonSunDistance = Math.hypot(moonPos.x, moonPos.y);
      const earthMoonDistance = Math.hypot(moonPos.x - earthPos.x, moonPos.y - earthPos.y);

      // alignment using dot product
      const dotProduct = (earthPos.x * moonPos.x + earthPos.y * moonPos.y) / (earthSunDistance * moonSunDistance || 1);
      const alignmentThreshold = 0.03; // tighter for more realistic alignment

      // Solar eclipse
      if (Math.abs(dotProduct - 1) < alignmentThreshold && moonSunDistance < earthSunDistance) {
        eclipses.push({
          type: 'solar',
          position: moonPos,
          intensity: Math.max(0, 1 - earthMoonDistance / earthSunDistance)
        });
      }

      // Lunar eclipse
      if (Math.abs(dotProduct - 1) < alignmentThreshold && moonSunDistance > earthSunDistance) {
        eclipses.push({
          type: 'lunar',
          position: earthPos,
          intensity: Math.max(0, 1 - earthMoonDistance / earthSunDistance)
        });
      }

      // Transit checks for Mercury and Venus (simplified)
      const mercuryPos = getPlanetPosition('mercury', time);
      const venusPos = getPlanetPosition('venus', time);
      const mercurySunDistance = Math.hypot(mercuryPos.x, mercuryPos.y);
      const venusSunDistance = Math.hypot(venusPos.x, venusPos.y);
      const earthSun = earthSunDistance;

      // small threshold for transit alignment
      const transitThreshold = 0.02;
      const mercDot = ((sunPos.x * mercuryPos.x + sunPos.y * mercuryPos.y) / (mercurySunDistance || 1));
      const venDot = ((sunPos.x * venusPos.x + sunPos.y * venusPos.y) / (venusSunDistance || 1));

      if (Math.abs(mercDot - 1) < transitThreshold && mercurySunDistance < earthSun) {
        eclipses.push({ type: 'transit', body: 'mercury', position: mercuryPos, intensity: 0.3 });
      }
      if (Math.abs(venDot - 1) < transitThreshold && venusSunDistance < earthSun) {
        eclipses.push({ type: 'transit', body: 'venus', position: venusPos, intensity: 0.5 });
      }

      return eclipses;
    }

    // ----- Canvas sizing and rendering -----
    function resizeCanvas() {
      const rect = canvas.getBoundingClientRect();
      // set canvas pixel size to match display size for crispness
      const dpr = window.devicePixelRatio || 1;
      canvas.width = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);
      canvas.style.width = rect.width + 'px';
      canvas.style.height = rect.height + 'px';
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0); // normalize drawing for DPR
    }

    function draw() {
      // Clear
      ctx.fillStyle = '#000011';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // compute center based on viewpoint
      const cw = canvas.width / (window.devicePixelRatio || 1);
      const ch = canvas.height / (window.devicePixelRatio || 1);
      let centerX = cw / 2;
      let centerY = ch / 2;

      // If earth-centered viewpoint, offset so earth is centered
      if (viewpoint === 'earth') {
        const earthPos = getPlanetPosition('earth', currentTime);
        centerX = cw / 2 - earthPos.x;
        centerY = ch / 2 - earthPos.y;
      }

      // Detect eclipses FIRST to determine color changes
      const eclipses = detectEclipses(currentTime);
      let isLunarEclipse = false;
      let isSolarEclipse = false;
      
      for (const eclipse of eclipses) {
        if (eclipse.type === 'lunar') isLunarEclipse = true;
        if (eclipse.type === 'solar') isSolarEclipse = true;
      }

      // Draw orbit rings
      ctx.save();
      ctx.strokeStyle = 'rgba(100,110,150,0.12)';
      ctx.lineWidth = 1;
      Object.values(celestialBodies).forEach(body => {
        if (body.distance > 0) {
          ctx.beginPath();
          ctx.ellipse(centerX, centerY, body.distance, body.distance, 0, 0, Math.PI * 2);
          ctx.stroke();
        }
      });
      ctx.restore();

      // Draw bodies with color changes during eclipses
      Object.entries(celestialBodies).forEach(([name, body]) => {
        let pos = { x: 0, y: 0 };
        if (name === 'moon') pos = getMoonPosition(currentTime);
        else pos = getPlanetPosition(name, currentTime);

        const x = centerX + pos.x;
        const y = centerY + pos.y;

        // Determine color based on eclipse state
        let planetColor = body.color;
        
        // Moon turns red/orange during lunar eclipse (Blood Moon effect)
        if (name === 'moon' && isLunarEclipse) {
          planetColor = '#DC143C'; // Crimson red for Blood Moon
        }
        
        // Sun appears dimmer during solar eclipse
        if (name === 'sun' && isSolarEclipse) {
          planetColor = '#CC9900'; // Darker gold during eclipse
        }

        // draw planet
        ctx.beginPath();
        ctx.fillStyle = planetColor;
        ctx.arc(x, y, body.radius, 0, Math.PI * 2);
        ctx.fill();
        ctx.lineWidth = 1;
        ctx.strokeStyle = 'rgba(0,0,0,0.2)';
        ctx.stroke();

        // Sun glow (adjusted during solar eclipse)
        if (name === 'sun') {
          const glowIntensity = isSolarEclipse ? 0.5 : 0.95;
          const g = ctx.createRadialGradient(x, y, 0, x, y, body.radius * 4);
          g.addColorStop(0, `rgba(255,215,0,${glowIntensity})`);
          g.addColorStop(0.4, `rgba(255,215,0,${glowIntensity * 0.35})`);
          g.addColorStop(1, 'rgba(255,215,0,0)');
          ctx.fillStyle = g;
          ctx.beginPath();
          ctx.arc(x, y, body.radius * 4, 0, Math.PI * 2);
          ctx.fill();
        }

        // Moon glow during lunar eclipse (red halo)
        if (name === 'moon' && isLunarEclipse) {
          const redGlow = ctx.createRadialGradient(x, y, 0, x, y, body.radius * 3);
          redGlow.addColorStop(0, 'rgba(220,20,60,0.8)');
          redGlow.addColorStop(0.5, 'rgba(220,20,60,0.4)');
          redGlow.addColorStop(1, 'rgba(220,20,60,0)');
          ctx.fillStyle = redGlow;
          ctx.beginPath();
          ctx.arc(x, y, body.radius * 3, 0, Math.PI * 2);
          ctx.fill();
        }

        // Label
        if (showLabels) {
          ctx.fillStyle = '#ffffff';
          ctx.font = '12px Inter, Arial';
          ctx.textAlign = 'center';
          ctx.fillText(capitalize(name), x, y - body.radius - 8);
        }
      });

      // Render eclipse effects
      let statusText = 'No eclipse currently visible';
      for (const eclipse of eclipses) {
        const ex = centerX + eclipse.position.x;
        const ey = centerY + eclipse.position.y;
        if (eclipse.type === 'solar') {
          // dark circle (moon) and corona
          ctx.fillStyle = 'rgba(0,0,0,0.9)';
          ctx.beginPath();
          ctx.arc(ex, ey, celestialBodies.moon.radius * 1.6, 0, Math.PI * 2);
          ctx.fill();
          // corona
          const grad = ctx.createRadialGradient(ex, ey, celestialBodies.moon.radius * 1.3, ex, ey, celestialBodies.moon.radius * 4);
          grad.addColorStop(0, 'rgba(255,255,255,0.95)');
          grad.addColorStop(1, 'rgba(255,255,255,0)');
          ctx.fillStyle = grad;
          ctx.beginPath();
          ctx.arc(ex, ey, celestialBodies.moon.radius * 4, 0, Math.PI * 2);
          ctx.fill();
          statusText = 'Solar eclipse happening';
        } else if (eclipse.type === 'lunar') {
          // red shadow on moon (render at earth position)
          const ex2 = centerX + eclipse.position.x;
          const ey2 = centerY + eclipse.position.y;
          const g2 = ctx.createRadialGradient(ex2, ey2, 0, ex2, ey2, celestialBodies.earth.radius * 2.4);
          g2.addColorStop(0, 'rgba(139,0,0,0.7)');
          g2.addColorStop(1, 'rgba(139,0,0,0)');
          ctx.fillStyle = g2;
          ctx.beginPath();
          ctx.arc(ex2, ey2, celestialBodies.earth.radius * 2.4, 0, Math.PI * 2);
          ctx.fill();
          statusText = 'Lunar eclipse happening - Moon appears red!';
        } else if (eclipse.type === 'transit') {
          // small dark dot on sun
          const ex3 = centerX + eclipse.position.x;
          const ey3 = centerY + eclipse.position.y;
          const rad = celestialBodies[eclipse.body].radius * 0.8;
          ctx.fillStyle = 'rgba(0,0,0,0.95)';
          ctx.beginPath();
          ctx.arc(ex3, ey3, rad, 0, Math.PI * 2);
          ctx.fill();
          statusText = `${capitalize(eclipse.body)} transit visible`;
        }
      }

      // update status text and eclipse info area
      simStatus.textContent = statusText;
      const currentInfo = eclipseInfo[selectedEclipseType];
      eclipseTitle.textContent = currentInfo.title;
      eclipseDesc.textContent = currentInfo.description;
      eclipseImage.src = currentInfo.image;

    } // draw()

    // helper
    function capitalize(s) { return typeof s === 'string' ? s.charAt(0).toUpperCase() + s.slice(1) : s; }

    // animation loop
    let rafId = null;
    function loop() {
      draw();
      if (isPlaying) currentTime += simulationSpeed * 0.1;
      rafId = requestAnimationFrame(loop);
    }

    // UI wiring
    speedRange.addEventListener('input', (e) => {
      simulationSpeed = parseFloat(e.target.value);
      speedLabel.textContent = simulationSpeed.toFixed(1) + 'x';
    });

    playPauseBtn.addEventListener('click', () => {
      isPlaying = !isPlaying;
      playPauseBtn.textContent = isPlaying ? 'Pause' : 'Play';
    });

    resetBtn.addEventListener('click', () => {
      currentTime = 0;
      simulationSpeed = 1;
      speedRange.value = 1;
      speedLabel.textContent = '1.0x';
    });

    viewpointSelect.addEventListener('change', (e) => {
      viewpoint = e.target.value;
    });

    showLabelsCheckbox.addEventListener('change', (e) => {
      showLabels = e.target.checked;
    });

    btnSolar.addEventListener('click', () => setEclipseType('solar'));
    btnLunar.addEventListener('click', () => setEclipseType('lunar'));
    btnTransit.addEventListener('click', () => setEclipseType('transit'));

    function setEclipseType(type) {
      selectedEclipseType = type;
      // visual active button style
      [btnSolar, btnLunar, btnTransit].forEach(b => b.classList.remove('active-type'));
      if (type === 'solar') btnSolar.classList.add('active-type');
      if (type === 'lunar') btnLunar.classList.add('active-type');
      if (type === 'transit') btnTransit.classList.add('active-type');
      // update info immediately
      const info = eclipseInfo[type];
      eclipseTitle.textContent = info.title;
      eclipseDesc.textContent = info.description;
      eclipseImage.src = info.image;
    }

    // initial active
    setEclipseType('solar');

    // handle resize
    function onResize() {
      // set canvas style size based on its container
      const wrap = document.getElementById('canvas-wrap');
      if (!wrap) return;
      const rect = wrap.getBoundingClientRect();
      canvas.style.width = rect.width - 24 + 'px'; // minus padding
      canvas.style.height = '520px';
      resizeCanvas();
    }
    window.addEventListener('resize', onResize);

    // initialize sizes and start loop
    onResize();
    loop();

    // ===== DEDICATED ECLIPSE DEMO SIMULATION =====
    const demoCanvas = document.getElementById('eclipseDemo');
    const demoCtx = demoCanvas.getContext('2d');
    const demoStatus = document.getElementById('demoStatus');
    const btnDemoSolar = document.getElementById('demoSolar');
    const btnDemoLunar = document.getElementById('demoLunar');

    let demoAnimationFrame = null;
    let demoProgress = 0;
    let demoType = null; // 'solar' or 'lunar'
    let isAnimatingDemo = false;

    function resizeDemoCanvas() {
      const rect = demoCanvas.getBoundingClientRect();
      const dpr = window.devicePixelRatio || 1;
      demoCanvas.width = Math.floor(rect.width * dpr);
      demoCanvas.height = Math.floor(rect.height * dpr);
      demoCanvas.style.width = rect.width + 'px';
      demoCanvas.style.height = rect.height + 'px';
      demoCtx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }

    function drawEclipseDemo() {
      const cw = demoCanvas.width / (window.devicePixelRatio || 1);
      const ch = demoCanvas.height / (window.devicePixelRatio || 1);

      // Clear
      demoCtx.fillStyle = '#000011';
      demoCtx.fillRect(0, 0, demoCanvas.width, demoCanvas.height);

      // Draw stars background
      demoCtx.fillStyle = '#ffffff';
      for (let i = 0; i < 100; i++) {
        const sx = (i * 137.5) % cw;
        const sy = (i * 241.3) % ch;
        demoCtx.fillRect(sx, sy, 1, 1);
      }

      if (!demoType) {
        // Show instruction text
        demoCtx.fillStyle = '#ffffff';
        demoCtx.font = '18px Inter, Arial';
        demoCtx.textAlign = 'center';
        demoCtx.fillText('Select an eclipse type to begin simulation', cw / 2, ch / 2);
        return;
      }

      if (demoType === 'solar') {
        // Solar Eclipse: Moon passes between Sun and Earth
        // Sun on left, Earth on right, Moon moves from right to left
        const sunX = cw * 0.2;
        const sunY = ch / 2;
        const earthX = cw * 0.8;
        const earthY = ch / 2;

        // Moon position interpolates from right of sun to between sun and earth
        const moonStartX = sunX + 80;
        const moonEndX = sunX + 10;
        const moonX = moonStartX + (moonEndX - moonStartX) * (demoProgress / 100);
        const moonY = sunY;

        // Draw Sun
        const sunRadius = 40;
        const sunGradient = demoCtx.createRadialGradient(sunX, sunY, 0, sunX, sunY, sunRadius);
        sunGradient.addColorStop(0, '#FFD700');
        sunGradient.addColorStop(1, '#FFA500');
        demoCtx.fillStyle = sunGradient;
        demoCtx.beginPath();
        demoCtx.arc(sunX, sunY, sunRadius, 0, Math.PI * 2);
        demoCtx.fill();

        // Sun glow
        const glowGradient = demoCtx.createRadialGradient(sunX, sunY, sunRadius, sunX, sunY, sunRadius * 2);
        glowGradient.addColorStop(0, 'rgba(255,215,0,0.4)');
        glowGradient.addColorStop(1, 'rgba(255,215,0,0)');
        demoCtx.fillStyle = glowGradient;
        demoCtx.beginPath();
        demoCtx.arc(sunX, sunY, sunRadius * 2, 0, Math.PI * 2);
        demoCtx.fill();

        // Draw Earth
        const earthRadius = 20;
        const earthGradient = demoCtx.createRadialGradient(earthX, earthY, 0, earthX, earthY, earthRadius);
        earthGradient.addColorStop(0, '#6B93D6');
        earthGradient.addColorStop(1, '#4A6FA5');
        demoCtx.fillStyle = earthGradient;
        demoCtx.beginPath();
        demoCtx.arc(earthX, earthY, earthRadius, 0, Math.PI * 2);
        demoCtx.fill();

        // Draw Moon (moving)
        const moonRadius = 15;
        demoCtx.fillStyle = '#C0C0C0';
        demoCtx.beginPath();
        demoCtx.arc(moonX, moonY, moonRadius, 0, Math.PI * 2);
        demoCtx.fill();

        // Shadow cone from moon (during eclipse)
        if (demoProgress > 40 && demoProgress < 60) {
          demoCtx.strokeStyle = 'rgba(0,0,0,0.3)';
          demoCtx.lineWidth = 2;
          demoCtx.setLineDash([5, 5]);
          demoCtx.beginPath();
          demoCtx.moveTo(moonX, moonY - moonRadius);
          demoCtx.lineTo(earthX, earthY - 10);
          demoCtx.moveTo(moonX, moonY + moonRadius);
          demoCtx.lineTo(earthX, earthY + 10);
          demoCtx.stroke();
          demoCtx.setLineDash([]);

          // Corona effect during totality
          const coronaGrad = demoCtx.createRadialGradient(moonX, moonY, moonRadius, moonX, moonY, moonRadius * 2);
          coronaGrad.addColorStop(0, 'rgba(255,255,255,0.8)');
          coronaGrad.addColorStop(1, 'rgba(255,255,255,0)');
          demoCtx.fillStyle = coronaGrad;
          demoCtx.beginPath();
          demoCtx.arc(moonX, moonY, moonRadius * 2, 0, Math.PI * 2);
          demoCtx.fill();
        }

        // Labels
        demoCtx.fillStyle = '#ffffff';
        demoCtx.font = '14px Inter, Arial';
        demoCtx.textAlign = 'center';
        demoCtx.fillText('Sun', sunX, sunY - sunRadius - 10);
        demoCtx.fillText('Moon', moonX, moonY - moonRadius - 10);
        demoCtx.fillText('Earth', earthX, earthY + earthRadius + 20);

        // Status
        if (demoProgress > 45 && demoProgress < 55) {
          demoStatus.textContent = 'üåë Total Solar Eclipse - Moon blocks the Sun!';
        } else if (demoProgress > 30 && demoProgress < 70) {
          demoStatus.textContent = 'üåó Partial Solar Eclipse in progress...';
        } else {
          demoStatus.textContent = '‚òÄÔ∏è Moon approaching the Sun...';
        }

      } else if (demoType === 'lunar') {
        // Lunar Eclipse: Earth passes between Sun and Moon
        // Sun on left, Earth in middle, Moon on right moving through Earth's shadow
        const sunX = cw * 0.15;
        const sunY = ch / 2;
        const earthX = cw / 2;
        const earthY = ch / 2;

        // Moon moves from right to left through Earth's shadow
        const moonStartX = cw * 0.9;
        const moonEndX = cw * 0.5;
        const moonX = moonStartX + (moonEndX - moonStartX) * (demoProgress / 100);
        const moonY = sunY;

        // Draw Sun
        const sunRadius = 35;
        const sunGradient = demoCtx.createRadialGradient(sunX, sunY, 0, sunX, sunY, sunRadius);
        sunGradient.addColorStop(0, '#FFD700');
        sunGradient.addColorStop(1, '#FFA500');
        demoCtx.fillStyle = sunGradient;
        demoCtx.beginPath();
        demoCtx.arc(sunX, sunY, sunRadius, 0, Math.PI * 2);
        demoCtx.fill();

        // Draw Earth
        const earthRadius = 25;
        const earthGradient = demoCtx.createRadialGradient(earthX, earthY, 0, earthX, earthY, earthRadius);
        earthGradient.addColorStop(0, '#6B93D6');
        earthGradient.addColorStop(1, '#4A6FA5');
        demoCtx.fillStyle = earthGradient;
        demoCtx.beginPath();
        demoCtx.arc(earthX, earthY, earthRadius, 0, Math.PI * 2);
        demoCtx.fill();

        // Draw Earth's shadow cone
        demoCtx.fillStyle = 'rgba(0,0,0,0.3)';
        demoCtx.beginPath();
        demoCtx.moveTo(earthX, earthY - earthRadius);
        demoCtx.lineTo(earthX + 250, earthY - 15);
        demoCtx.lineTo(earthX + 250, earthY + 15);
        demoCtx.lineTo(earthX, earthY + earthRadius);
        demoCtx.closePath();
        demoCtx.fill();

        // Shadow cone outline
        demoCtx.strokeStyle = 'rgba(139,0,0,0.5)';
        demoCtx.lineWidth = 2;
        demoCtx.setLineDash([5, 5]);
        demoCtx.beginPath();
        demoCtx.moveTo(earthX, earthY - earthRadius);
        demoCtx.lineTo(earthX + 250, earthY - 15);
        demoCtx.moveTo(earthX, earthY + earthRadius);
        demoCtx.lineTo(earthX + 250, earthY + 15);
        demoCtx.stroke();
        demoCtx.setLineDash([]);

        // Draw Moon
        const moonRadius = 12;
        let moonColor = '#C0C0C0';
        
        // Check if moon is in shadow (turn red)
        const distanceToShadow = Math.abs(moonX - (earthX + 100));
        if (moonX > earthX + 50 && moonX < earthX + 200) {
          // Moon in shadow - Blood Moon effect
          moonColor = '#DC143C';
          
          // Red glow around Blood Moon
          const bloodGlow = demoCtx.createRadialGradient(moonX, moonY, moonRadius, moonX, moonY, moonRadius * 2.5);
          bloodGlow.addColorStop(0, 'rgba(220,20,60,0.8)');
          bloodGlow.addColorStop(1, 'rgba(220,20,60,0)');
          demoCtx.fillStyle = bloodGlow;
          demoCtx.beginPath();
          demoCtx.arc(moonX, moonY, moonRadius * 2.5, 0, Math.PI * 2);
          demoCtx.fill();
        }

        demoCtx.fillStyle = moonColor;
        demoCtx.beginPath();
        demoCtx.arc(moonX, moonY, moonRadius, 0, Math.PI * 2);
        demoCtx.fill();

        // Labels
        demoCtx.fillStyle = '#ffffff';
        demoCtx.font = '14px Inter, Arial';
        demoCtx.textAlign = 'center';
        demoCtx.fillText('Sun', sunX, sunY - sunRadius - 10);
        demoCtx.fillText('Earth', earthX, earthY - earthRadius - 10);
        demoCtx.fillText('Moon', moonX, moonY + moonRadius + 20);

        // Status
        if (moonX > earthX + 80 && moonX < earthX + 150) {
          demoStatus.textContent = 'üî¥ Total Lunar Eclipse - Blood Moon visible!';
        } else if (moonX > earthX + 50 && moonX < earthX + 200) {
          demoStatus.textContent = 'üåì Partial Lunar Eclipse in progress...';
        } else {
          demoStatus.textContent = 'üåï Moon approaching Earth\'s shadow...';
        }
      }
    }

    function animateEclipseDemo() {
      drawEclipseDemo();
      
      if (isAnimatingDemo) {
        demoProgress += 0.5;
        if (demoProgress > 100) {
          demoProgress = 0;
        }
        demoAnimationFrame = requestAnimationFrame(animateEclipseDemo);
      }
    }

    function startEclipseDemo(type) {
      demoType = type;
      demoProgress = 0;
      isAnimatingDemo = true;
      
      if (demoAnimationFrame) {
        cancelAnimationFrame(demoAnimationFrame);
      }
      
      animateEclipseDemo();
    }

    btnDemoSolar.addEventListener('click', () => {
      startEclipseDemo('solar');
    });

    btnDemoLunar.addEventListener('click', () => {
      startEclipseDemo('lunar');
    });

    // Handle demo canvas resize
    window.addEventListener('resize', resizeDemoCanvas);
    resizeDemoCanvas();
    drawEclipseDemo(); // Initial draw
  </script>
</body>
</html>